<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coy.js TodoApp example</title>
  </head>
  <body>
    <div id="app"></div>
    <script src="https://cdn.tailwindcss.com"></script>

    <script type="module">
      import { bootstrap } from "/bootstrap.mjs";
      import { signal, react } from "/signal.mjs";
      import {
        Show,
        List,
        Div,
        Fragment,
        Button,
        Br,
        props,
        Input,
      } from "/components.mjs";
      import {
        RouteLink,
        RoutesProvider,
        RouteOutlet,
        useRouter,
      } from "/coy-route.mjs";
      import { TodoPage } from "/pages/TodoPage.mjs";
      import { FragmentTest } from "/pages/FragmentTest.mjs";
      import { ListExample } from "/pages/ListExample.mjs";
      import { NotFound } from "/pages/NotFound.mjs";
      import { Counter } from "/pages/Counter.mjs";
      import { StyledTestComponent } from "/pages/StyledTest.mjs";

      /*
        {
              path: "teste",
              component: () => Div("1", RouteOutlet()),
              routes: [
                {
                  path: "inside",
                  component: () => Div("2", RouteOutlet()),
                  routes: [{ path: "again", component: () => Div("3") }],
                },
              ],
            },
            {
              path: "home",
              component: () => {
                const [text, setText] = signal(Math.random().toString(36));

                // setInterval(() => {
                //   setText(Math.random().toString(36));
                // }, 4000);

                return Div(props({ id: "qualquer" }), text, RouteOutlet());
              },
              routes: [
                {
                  path: "sub-route",
                  component: () => Div("/home/subroute", RouteOutlet()),
                  routes: [
                    {
                      path: "dentro",
                      component: () =>
                        Div(
                          "sub-route/child",
                          Br(),
                          Br(),
                          RouteLink(
                            `/home/sub-route`,
                            props({
                              className:
                                "border-2 border-red-500 cursor-pointer",
                              href: "/home/sub-route",
                            })
                          ),
                          Br(),
                          Br(),
                          RouteLink(
                            `/teste/inside/again`,
                            props({
                              className:
                                "border-2 border-red-500 cursor-pointer",
                              href: "/teste/inside/again",
                            })
                          ),
                          Br(),
                          Br(),
                          RouteLink(
                            `altos nada`,
                            props({
                              className:
                                "border-2 border-red-500 cursor-pointer",
                              href: "/",
                            })
                          ),
                          RouteOutlet()
                        ),
                    },
                  ],
                },
              ],
            },
      */

      const routes = [
        {
          path: "/",
          component: () => {
            const router = useRouter();

            const curRoute = router.route();
            if (router.route() === "/") {
              router.navigate("/todo");
            }

            return Div(
              Div(
                props({
                  className:
                    "flex items-center gap-4 p-4 text-lg [&>a:hover]:underline overflow-x-auto",
                }),
                RouteLink("TodoApp", props({ href: "/todo" })),
                RouteLink("FragmentTest", props({ href: "/fragment" })),
                RouteLink("ListExample", props({ href: "/list" })),
                RouteLink("NotFound", props({ href: "/not-found" })),
                RouteLink("Counter", props({ href: "/counter" })),
                RouteLink("StyledTest", props({ href: "/styled" })),
                Input({
                  className: "border-2 px-2 rounded",
                  placeholder: "type something here",
                })
              ),

              RouteOutlet()
            );
          },
          routes: [
            { path: "todo", component: () => TodoPage() },
            { path: "fragment", component: () => FragmentTest() },
            { path: "list", component: () => ListExample() },
            { path: "not-found", component: () => NotFound() },
            { path: "counter", component: () => Counter() },
            { path: "styled", component: () => StyledTestComponent() },
          ],
        },
      ];

      const Home = () => {
        return Fragment(RoutesProvider(routes, {}));
      };

      bootstrap(app, Home);
    </script>
  </body>
</html>
