<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coy.js TodoApp example</title>
  </head>
  <body>
    <div id="app"></div>
    <script src="https://cdn.tailwindcss.com"></script>

    <script type="module">
      import { Counter } from "/pages/Counter.mjs";
      import { bootstrap } from "/bootstrap.mjs";
      import { FragmentTest } from "/pages/Fragment.mjs";
      import {signal, react} from "/signal.mjs"
      import {Show, List, Div, Fragment, props} from "/components.mjs"
      import {RouteLink, RoutesProvider, RouteOutlet} from "/coy-route.mjs"

      const Home = () => {
        const [random, setRandom] = signal(Math.random().toString(36));
        
        return Fragment(
          Div(
            props({
              className: "flex gap-4 p-4 text-lg",
            }),
            RouteLink("/home", props({ href: "/home" })),
            RouteLink("/home/inside", props({ href: "/home/inside" })),
            RouteLink(
              "NotFound",
              props({
                href: random,
                onclick: () => setRandom(Math.random().toString(36)),
              })
            )
          ),

          // so basicaly we will
          RoutesProvider([
            // {
            //   path: "/",
            //   component: () => Div("aqui"),
            // },
            {
              path: "home",
              component: () => {
                const [text, setText] = signal(Math.random().toString(36));

                // setInterval(() => {
                //   setText(Math.random().toString(36));
                // }, 4000);

                return Div(props({ id: "qualquer" }), text, RouteOutlet());
              },
              routes: [
                {
                  path: "/",
                  component: () => Div("/home/inside", RouteOutlet()),
                },
                {
                  path: "sub-route",
                  component: () => Div("/home/subroute", RouteOutlet()),
                  routes: [
                    {
                      path: "/",
                      component: () => Div("sub-route/child", RouteOutlet()),
                    },
                  ],
                },
              ],
            },
          ])
        );
      };

      const ListExample = () => {
        const [list, setList] = signal([
          { label: "example1" },
          { label: "example2" },
          { label: "example3" },
          { label: "example4" },
          { label: "example5" },
          { label: "example6" },
        ]);

        // setInterval(() => {
        //   setList((old) => [...old, { label: Math.random().toString() }]);
        // }, 200);

        // setInterval(() => {
        //   setList((old) => old.reverse());
        // }, 2000);

        return Show({
          when: react(() => true),
          content: List({
            data: list,
            render: (item) => Div(item().label),
            keyExtractor: (item) => item().label,
          }),
        });
      };

      bootstrap(app, Home);
    </script>
  </body>
</html>
